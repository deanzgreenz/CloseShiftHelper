<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Close Shift & Daily Deposit Helper</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body { font-family: Arial,sans-serif; padding: 20px; }
    h1 { margin-bottom: 10px; }
    .tabs { display: flex; margin-bottom: 20px; }
    .tab {
      padding: 8px 16px; cursor: pointer;
      border: 1px solid #ccc; background: #f0f0f0;
      margin-right: 4px;
    }
    .tab.active { background: #fff; font-weight: bold; }
    .panel { border: 1px solid #ccc; padding: 20px; display: none; }
    .panel.active { display: block; }
    table { width: 100%; border-collapse: collapse; margin: 15px 0; }
    th, td { border: 1px solid #ddd; padding: 6px; text-align: center; }
    label { display: inline-block; width: 300px; margin-bottom: 6px; }
    input[type=number] { width: 80px; padding: 4px; }
    .actions { margin-top: 12px; }
    .actions button { padding: 6px 12px; margin-right: 8px; }
    em { color: #555; font-size: 0.9em; }
  </style>
</head>
<body>
  <h1>Close Shift & Daily Deposit Helper</h1>

  <div class="tabs">
    <div class="tab active" data-target="close-shift">Close Shift</div>
    <div class="tab" data-target="daily-deposit">Complete Daily Deposit</div>
  </div>

  <!-- Close Shift Panel -->
  <div id="close-shift" class="panel active">
    <h2>Close Shift</h2>
    <div>
      <label>Bills (After $480 removed for Reset Till):</label>
      <input id="bills" type="number" step="0.01" value="0">
      <strong>Total Cash From Cash Counter</strong>
    </div>

    <h3>Till Flipper</h3>
    <table>
      <thead>
        <tr><th>Coin</th><th>Par</th><th>Counted</th><th>Action</th></tr>
      </thead>
      <tbody>
        <tr>
          <td>Quarters</td><td>10</td>
          <td><input class="coin" data-par="10" id="quarters" type="number" step="0.01" value="10"></td>
          <td id="act-quarters"></td>
        </tr>
        <tr>
          <td>Dimes</td><td>5</td>
          <td><input class="coin" data-par="5" id="dimes" type="number" step="0.01" value="5"></td>
          <td id="act-dimes"></td>
        </tr>
        <tr>
          <td>Nickels</td><td>4</td>
          <td><input class="coin" data-par="4" id="nickels" type="number" step="0.01" value="4"></td>
          <td id="act-nickels"></td>
        </tr>
        <tr>
          <td>Pennies</td><td>1</td>
          <td><input class="coin" data-par="1" id="pennies" type="number" step="0.01" value="1"></td>
          <td id="act-pennies"></td>
        </tr>
        <tr>
          <td>Dollar Coins</td><td>0</td>
          <td><input class="coin" data-par="0" id="dollarcoins" type="number" step="1" value="0"></td>
          <td id="act-dollarcoins"></td>
        </tr>
      </tbody>
    </table>

    <div>
      <label>Total Coin Adjustment ($):</label>
      <span id="coin-adjustment">0.00</span>
      <em>: Write this total on the Shift Report Receipt</em>
    </div>
    <div>
      <label>Total Cash Drop ($):</label>
      <span id="cash-drop">0.00</span>
      <em>: Enter this total into POSaBIT as the Closing Drop field, and $500 in Left In Drawer</em>
    </div>

    <div class="actions">
      <button id="calc-close-shift">Calculate Close Shift</button>
    </div>
  </div>

  <!-- Daily Deposit Panel -->
  <div id="daily-deposit" class="panel">
    <h2>Complete Daily Deposit</h2>
    <div>
      <label>Total Closing Cash ($):</label>
      <input id="closing-cash" type="number" step="0.01" value="0">
      <em>: Remaining cash after Taxes & Vendor Bills</em>
    </div>

    <h3>Shift Coin Adjustments</h3>
    <div id="coin-adjust-list">
      <div><label>Shift 1:</label> <input class="shift-coin" type="number" step="0.01" value="0"></div>
      <div><label>Shift 2:</label> <input class="shift-coin" type="number" step="0.01" value="0"></div>
      <div><label>Shift 3:</label> <input class="shift-coin" type="number" step="0.01" value="0"></div>
      <div><label>Shift 4:</label> <input class="shift-coin" type="number" step="0.01" value="0"></div>
      <div><label>Shift 5:</label> <input class="shift-coin" type="number" step="0.01" value="0"></div>
      <div><label>Shift 6:</label> <input class="shift-coin" type="number" step="0.01" value="0"></div>
    </div>
    <div>
      <label>Total Closing Coin Adjustments ($):</label>
      <span id="total-coin-adjust-shifts">0.00</span>
    </div>

    <div>
      <label>Actual Deposit ($):</label>
      <span id="actual-deposit">0.00</span>
    </div>
    <div>
      <label>Net Deposit ($):</label>
      <span id="net-deposit">0.00</span>
    </div>
    <div>
      <label>Difference ($):</label>
      <span id="difference-deposit">0.00</span>
    </div>

    <div class="actions">
      <button id="calc-daily-deposit">Calculate Deposit</button>
      <button id="export-excel">Save Daily Deposit Sheet</button>
    </div>
  </div>

  <script>
  document.addEventListener('DOMContentLoaded', ()=> {
    // Tab switching
    document.querySelectorAll('.tab').forEach(tab=>{
      tab.addEventListener('click', ()=>{
        document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
        document.querySelectorAll('.panel').forEach(p=>p.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(tab.dataset.target).classList.add('active');
      });
    });

    // Close Shift
    document.getElementById('calc-close-shift').addEventListener('click', ()=>{
      const billVal = parseFloat(document.getElementById('bills').value)||0;
      let coinAdj=0;
      document.querySelectorAll('.coin').forEach(inp=>{
        const par=+inp.dataset.par, val=+inp.value||0, diff=val-par;
        coinAdj+=diff;
        const cell=document.getElementById('act-'+inp.id);
        cell.textContent = diff===0 ? 'OK'
          : diff>0 ? 'Remove '+diff.toFixed(2)
          : 'Add '+(-diff).toFixed(2);
      });
      document.getElementById('coin-adjustment').textContent = coinAdj.toFixed(2);
      document.getElementById('cash-drop').textContent = (billVal+coinAdj).toFixed(2);
    });

    // Daily Deposit
    document.getElementById('calc-daily-deposit').addEventListener('click', ()=>{
      const closeCash=+document.getElementById('closing-cash').value||0;
      let sumShifts=0;
      document.querySelectorAll('.shift-coin').forEach(inp=> sumShifts+=+inp.value||0 );
      document.getElementById('total-coin-adjust-shifts').textContent = sumShifts.toFixed(2);

      const actual = closeCash + sumShifts;
      document.getElementById('actual-deposit').textContent = actual.toFixed(2);

      // Net Deposit = ?(from URL)
      const params=new URLSearchParams(location.search);
      const t=+params.get('tendered')||0, x=+params.get('tax')||0;
      const net = t - x;
      document.getElementById('net-deposit').textContent = net.toFixed(2);
      document.getElementById('difference-deposit').textContent = (actual - net).toFixed(2);
    });

    document.getElementById('export-excel').addEventListener('click', ()=>{
      alert('Excel export not yet implemented');
    });
  });
  </script>
</body>
</html>
